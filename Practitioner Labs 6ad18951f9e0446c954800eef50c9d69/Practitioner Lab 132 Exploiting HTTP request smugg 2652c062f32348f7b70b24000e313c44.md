# Practitioner Lab 132: Exploiting HTTP request smuggling to reveal front-end request rewriting

[https://www.notion.so](https://www.notion.so)

---

This lab involves a front-end and back-end server, and the front-end server doesn't support chunked encoding.

There's an admin panel at `/admin`, but it's only accessible to people with the IP address 127.0.0.1. The front-end server adds an HTTP header to incoming requests containing their IP address. It's similar to the `X-Forwarded-For` header but has a different name.

To solve the lab, smuggle a request to the back-end server that reveals the header that is added by the front-end server. Then smuggle a request to the back-end server that includes the added header, accesses the admin panel, and deletes the user `carlos`.

![Untitled](Practitioner%20Lab%20132%20Exploiting%20HTTP%20request%20smugg%202652c062f32348f7b70b24000e313c44/Untitled.png)

![Untitled](Practitioner%20Lab%20132%20Exploiting%20HTTP%20request%20smugg%202652c062f32348f7b70b24000e313c44/Untitled%201.png)

The lab timed out meaning that it is a CLTE 

![Untitled](Practitioner%20Lab%20132%20Exploiting%20HTTP%20request%20smugg%202652c062f32348f7b70b24000e313c44/Untitled%202.png)

I was able to get this output with the following request 

![Untitled](Practitioner%20Lab%20132%20Exploiting%20HTTP%20request%20smugg%202652c062f32348f7b70b24000e313c44/Untitled%203.png)

Now the next step is to increase the content length to get more information on all the headers.

![Untitled](Practitioner%20Lab%20132%20Exploiting%20HTTP%20request%20smugg%202652c062f32348f7b70b24000e313c44/Untitled%204.png)

Here is the full header. Now I can use this to change my ip and access the /admin

```
X-QrPuGR-Ip: 99.246.87.219
```

![Untitled](Practitioner%20Lab%20132%20Exploiting%20HTTP%20request%20smugg%202652c062f32348f7b70b24000e313c44/Untitled%205.png)

![Untitled](Practitioner%20Lab%20132%20Exploiting%20HTTP%20request%20smugg%202652c062f32348f7b70b24000e313c44/Untitled%206.png)