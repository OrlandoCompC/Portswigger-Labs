# Practitioner Lab 56: Exploiting XInclude to retrieve files

---

This lab has a "Check stock" feature that embeds the user input inside a server-side XML document that is subsequently parsed.

Because you don't control the entire XML document you can't define a DTD to launch a classic [XXE](https://portswigger.net/web-security/xxe) attack.

To solve the lab, inject an `XInclude` statement to retrieve the contents of the `/etc/passwd` file.

I started by looking for a parameter that might be vulnerable, I then went into that vulnerable parameter and inserted the Xinsert.

```
<foo xmlns:xi="http://www.w3.org/2001/XInclude">
<xi:include parse="text" href="file:///etc/passwd"/></foo>
```

This gave me access to the file. 

![Untitled](Practitioner%20Lab%2056%20Exploiting%20XInclude%20to%20retriev%2061c1c4e478d24c55b53dfcb5acaac326/Untitled.png)

This allowed me to see the /etc/passwd